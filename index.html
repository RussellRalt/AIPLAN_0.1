<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>AIPLAN</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="auth-minimal.css" />
  <link rel="stylesheet" href="ai-minimal.css" />
  <link rel="manifest" href="manifest.json" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>  
  <!-- HEADER GLOBAL -->
  <header class="global-fixed-header" style="display: none;">
    <a href="#" id="appTitleLink" class="header-logo-container">
      <div class="header-app-icon">
        <span class="header-icon-text">AI</span>
      </div>
      <h1 class="header-app-title">PLAN</h1>
    </a>
    <h2 id="headerDynamicTitle"></h2>
    <div id="headerRightIcons">
      <div style="position: relative;">
        <button id="headerAuthIcon" class="icon-button" title="Autenticaci√≥n">üë§</button>
        <div id="userMenu"></div>
      </div>
    </div>
  </header>
  
  <!-- SECCI√ìN AUTENTICACI√ìN MINIMALISTA -->
  <section id="authSection">
    <div class="auth-minimal-container">
      <div class="auth-brand">
        <div class="brand-icon">AI</div>
        <h1 class="brand-title">PLAN</h1>
        <p class="brand-subtitle">Organiza tu vida con inteligencia</p>
      </div>
      
      <div class="auth-card" id="authCard">
        <!-- Vista inicial: Selector de acci√≥n -->
        <div id="authSelector" class="auth-view active">
          <button class="auth-btn primary" id="btnShowSignin">Iniciar sesi√≥n</button>
          <button class="auth-btn secondary" id="btnShowSignup">Crear cuenta</button>
        </div>
        
        <!-- Vista: Iniciar sesi√≥n -->
        <div id="signinView" class="auth-view">
          <button class="auth-back" id="backFromSignin">‚Üê</button>
          <h2 class="auth-title">Bienvenido de nuevo</h2>
          <form id="signinForm" class="auth-form-minimal">
            <div class="input-group">
              <input type="email" id="signinEmail" placeholder="Email" required autocomplete="email" />
            </div>
            <div class="input-group">
              <input type="password" id="signinPassword" placeholder="Contrase√±a" required autocomplete="current-password" />
            </div>
            <button type="submit" class="auth-btn primary full">Entrar</button>
          </form>
        </div>
        
        <!-- Vista: Crear cuenta -->
        <div id="signupView" class="auth-view">
          <button class="auth-back" id="backFromSignup">‚Üê</button>
          <h2 class="auth-title">Crea tu cuenta</h2>
          <form id="signupForm" class="auth-form-minimal">
            <div class="input-group">
              <input type="email" id="signupEmail" placeholder="Email" required autocomplete="email" />
            </div>
            <div class="input-group">
              <input type="password" id="signupPassword" placeholder="Contrase√±a (m√≠n. 6 caracteres)" required autocomplete="new-password" />
            </div>
            <button type="submit" class="auth-btn primary full">Crear cuenta</button>
          </form>
          <p class="auth-note">Recibir√°s un email de confirmaci√≥n</p>
        </div>
      </div>
    </div>
  </section>

  <!-- SECCI√ìN CARPETAS -->
  <section id="foldersSection">
    <div class="top-icon-bar">
      <button id="themeButton" class="icon-button" title="Cambiar tema">üåô</button>
      <label for="importFileInput" class="icon-button" id="importJsonBtn" title="Importar JSON">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="18" height="18" fill="currentColor">
          <path d="M169.4 470.6c4.5 4.5 10.6 7.4 17 7.4s12.5-2.9 17-7.4l160-160c9.2-9.2 12-22.9 7-34.9s-16.6-19.4-29-19.4H272V64c0-17.7-14.3-32-32-32H144c-17.7 0-32 14.3-32 32V256H29.7c-12.4 0-23.5 7.6-28.5 19.4s-2.2 25.7 7 34.9l160 160z"/>
        </svg>
      </label>
      <input type="file" id="importFileInput" accept="application/json" style="display: none;" />
      <button id="trashButton" class="icon-button" title="Ver papelera">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="18" height="18" fill="currentColor">
          <path d="M160 400C160 408.8 152.8 416 144 416C135.2 416 128 408.8 128 400V240C128 231.2 135.2 224 144 224C152.8 224 160 231.2 160 240V400zM256 240C256 231.2 263.2 224 272 224C280.8 224 288 231.2 288 240V400C288 408.8 280.8 416 272 416C263.2 416 256 408.8 256 400V240zM0 80C0 62.33 14.33 48 32 48H80L96.38 34C103.2 27.12 112.3 23.1 121.9 23.1H326.1C335.7 23.1 344.8 27.12 351.6 34L368 48H416C433.7 48 448 62.33 448 80C448 97.67 433.7 112 416 112H32C14.33 112 0 97.67 0 80zM32.11 160H415.9C419.8 160 423.5 161.7 426.2 164.4C428.8 167.1 430.7 170.8 431 174.8L416 464C416 490.5 394.5 512 368 512H80C53.49 512 32 490.5 32 464L16.1 174.8C17.21 168.1 24.56 160 32.11 160z"/>
        </svg>
      </button>
      <button id="entitiesButton" class="icon-button" title="Entidades">üë•</button>
    </div>
    <div class="new-folder">
      <input type="text" id="newFolderInput" class="new-folder-input" placeholder="Agrega una carpeta (Enter)..." />
    </div>
    <div class="folder-container" id="folderContainer"></div>
  </section>

  <!-- SECCI√ìN TAREAS -->
  <section id="tasksSection" style="display: none;">
    <div class="tasks-container">
      <div class="new-task">
        <input type="text" id="newTaskInput" placeholder="Agrega una tarea (Enter)..." />
        <input type="number" id="newTaskTimeInput" placeholder="Tiempo (min) (opcional)" min="0" />
      </div>
      <h3 class="subheading">Tareas Pendientes</h3>
      <div id="tasksList" class="tasks-list"></div>
      <div id="completedMiniFolder" class="mini-folder-container">
        <div class="mini-folder-icon" title="Tareas Finalizadas">üìÅ</div>
        <div id="completedMiniFolderList" class="tasks-list"></div>
      </div>
    </div>
  </section>

  <!-- SECCI√ìN PAPELERA -->
  <section id="trashSection" style="display: none;">
    <div id="trashList" class="trash-list"></div>
  </section>

  <!-- SECCI√ìN ENTIDADES -->
  <section id="entitiesSection" style="display: none;">
    <div class="entities-container">
      <h2>Entidades</h2>
      <div class="new-entity">
        <input type="text" id="newEntityInput" placeholder="Agrega una entidad (Enter)..." />
        <select id="entityTypeSelect">
          <option value="persona">Persona</option>
          <option value="institucion">Instituci√≥n</option>
        </select>
      </div>
      <div id="entitiesList" class="entities-list"></div>
      <div class="stats-container">
        <h3>Estad√≠sticas por Entidad</h3>
        <div id="statsChart"></div>
      </div>
    </div>
  </section>

  <!-- MODALES -->
  <div id="presentationModal" class="modal" style="display: none;"></div>
  <div id="scheduleModal" class="modal" style="display: none;">
    <div class="modal-content">
      <h3>Programar Tarea</h3>
      <input type="datetime-local" id="scheduleDateInput" />
      <button id="saveScheduleBtn">Guardar</button>
      <button id="cancelScheduleBtn">Cancelar</button>
    </div>
  </div>
  <div id="alarmModal" class="modal" style="display: none;">
    <div class="modal-content">
      <h3 id="alarmTitle">Alarma</h3>
      <button id="disableAlarmBtn">Desactivar</button>
    </div>
  </div>
  <div id="rewardSection" style="display: none;">
    <input type="text" id="rewardInput" placeholder="Escribe tu recompensa..." />
  </div>
  <div id="moveModal" class="modal" style="display: none;">
    <div class="modal-content">
      <h3>Mover Tarea</h3>
      <select id="targetFolderSelect"></select>
      <button id="confirmMoveBtn">Mover</button>
      <button id="cancelMoveBtn">Cancelar</button>
    </div>
  </div>
  <div id="confirmModal" class="modal" style="display: none;">
    <div class="modal-content">
      <p id="confirmMessage"></p>
      <button id="confirmYesBtn">S√≠</button>
      <button id="confirmNoBtn">No</button>
    </div>
  </div>
  <div id="chatModal" class="chat-modal">
    <div class="chat-header">
      <h3>Asistente</h3>
      <button id="closeChatBtn">√ó</button>
    </div>
    <div id="chatMessages" class="chat-messages"></div>
    <div class="chat-input-container">
      <input type="text" id="chatInput" placeholder="Pregunta lo que necesites..." />
      <button id="sendChatBtn">‚Üë</button>
    </div>
  </div>
  <button id="aiButton" style="display: none;">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff">
      <circle cx="12" cy="12" r="3" stroke-width="1.5"/>
      <path d="M12 2v4M12 18v4M22 12h-4M6 12H2" stroke-width="1.5" stroke-linecap="round"/>
      <path d="M19.07 4.93l-2.83 2.83M7.76 16.24l-2.83 2.83M19.07 19.07l-2.83-2.83M7.76 7.76L4.93 4.93" stroke-width="1.5" stroke-linecap="round" opacity="0.5"/>
    </svg>
  </button>
  <div id="shareModal" class="modal" style="display: none;">
    <div class="modal-content">
      <h3>Compartir Tarea</h3>
      <button id="whatsappShareBtn">WhatsApp</button>
      <button id="telegramShareBtn">Telegram</button>
      <button id="emailShareBtn">Email</button>
      <button id="facebookShareBtn">Facebook</button>
      <button id="twitterShareBtn">Twitter</button>
      <button id="linkedinShareBtn">LinkedIn</button>
      <button id="closeShareBtn">Cerrar</button>
    </div>
  </div>

  <script type="module" src="script.js"></script>
</body>
</html>
